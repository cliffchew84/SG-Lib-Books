{% include 'header.html' %}
{% include 'navbar.html' %}

<div class="px-5 md:px-1 flex flex-col justify-center items-center text-center">

    {% if not library %}

    {% include 'result_table.html' %}

    {% else %}

    {% include 'result_no_lib_table.html' %}

    {% endif %}

</div>

<script>
    $(document).ready(function () {
        const rows = $('#myTable tr');
        const availableCheckbox = $("#availableCheckbox");
        const searchInput = $("#myInput");

        // Function to handle filtering by "Available" status
        function filterByAvailability() {
            const checked = availableCheckbox.is(":checked");
            const searchValue = searchInput.val().toLowerCase();
            rows.each(function () {
                const status = $(this).find('td:nth-last-child(3)').text().toLowerCase();
                const rowText = $(this).text().toLowerCase();
                if ((checked && status.indexOf("available") === -1) || (searchValue.length > 0 && rowText.indexOf(searchValue) === -1)) {
                    $(this).hide();
                } else {
                    $(this).show();
                }
            });
        }

        // Function to handle real-time search
        function filterBySearch() {
            const checked = availableCheckbox.is(":checked");
            const searchValue = searchInput.val().toLowerCase();
            rows.each(function () {
                const rowText = $(this).text().toLowerCase();
                const status = $(this).find('td:nth-last-child(3)').text().toLowerCase();
                if ((checked && status.indexOf("available") === -1) || (searchValue.length > 0 && rowText.indexOf(searchValue) === -1)) {
                    $(this).hide();
                } else {
                    $(this).show();
                }
            });
        }

        // Attach event handlers to both the checkbox and the input field
        availableCheckbox.change(function () {
            filterByAvailability();
            filterBySearch();
        });

        searchInput.on("keyup", function () {
            filterByAvailability();
            filterBySearch();
        });
    });


</script>
{% include 'footer.html' %}
