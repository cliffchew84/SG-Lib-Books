{% include 'header.html' %}
{% include 'navbar.html' %}

<div class='items-center justify-center'>
    <form class="form-inline flex items-center justify-center" action="/{{username}}/search/" method="GET">
        <input class="flex mt-4 py-2 w-1/2 md:text-base text-sm form-control rounded-lg border-2 border-sky-700"
            placeholder="Search NLB books by title or ISBN" type="search" id="book_search" name="book_search" />

        <!--Search button-->
        <button type="submit"
            class="flex items-center bg-sky-700 mt-4 px-3 py-2 pb-2.5 rounded-lg hover:text-white hover:bg-sky-500 text-white">
            <i class="fas fa-search"></i>
        </button>
    </form>
    <p class='items-center mx-auto flex justify-center text-sm italic pt-1 w-3/4'>
        *Search may take awhile for generic keywords like "Python". Consider searching with ISBN
        to get the exact book, or type out the full book title.
    </p>
</div>

<div class="mx-auto max-w-screen-lg px-4 mt-3">
    {% if status %}

    {% include 'update_status.html' %}

    {% endif %}

    {% if keyword %}

    <table class="mx-auto table-auto border-collapse w-full table-sm divide-y divide-gray-800">
        <thead class='rounded-lg'>
            <tr class='bg-sky-700 text-white rounded-lg'>
                <th></th>
                <th>Results from <i>'{{keyword}}'</i>
                </th>
                <th>Author</th>
                <th>Year</th>
            </tr>
        </thead>
        <tbody id="myTable">

            {% for data in api_data %}

            <tr>
                {% for a in data %}

                {% if a == "BID" %}
                {% set disable, BID = data[a].split(' | ') %}

                <td>
                    <form action="/ingest_book/{{BID}}" method="POST">
                        <button type="submit" class="bg-sky-800 px-2 my-1 py-1 rounded-lg 
                                    hover:text-white hover:bg-sky-500 text-white disabled:bg-gray-400 
                                    disabled:hover:bg-gray-400" {{ disable }}>
                            <i class="fas fa-plus"></i>
                        </button>
                    </form>
                </td>

                {% elif a == "TitleName" %}
                {% set TitleName, BID = data[a].split(' | ') %}

                <td> <a href="https://eservice.nlb.gov.sg/item_holding.aspx?id={{BID}}&type=bid&app=mylibrary"
                        class="button text-blue-800 underline font-semibold" target="_blank" rel="noopener
                            noreferrer">{{ TitleName }}</a>

                    {% else %}

                <td>{{ data[a] }}</td>

                {% endif %}

                {% endfor %}
            </tr>
            {% endfor %}
        </tbody>
    </table>

    {% endif %}
</div>

{% include 'footer.html' %}
